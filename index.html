<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>TikTok Downloader – No Watermark</title>
  <style>
    :root {
      --primary: #6a11cb;
      --secondary: #2575fc;
      --success: #00c853;
      --error: #ff1744;
      --glass: rgba(255, 255, 255, 0.85);
      --radius: 14px;
    }
    *{box-sizing:border-box;margin:0;padding:0;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif}
    body{background:linear-gradient(135deg,var(--primary),var(--secondary));min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
    .card{width:100%;max-width:560px;background:var(--glass);backdrop-filter:blur(10px);border-radius:var(--radius);box-shadow:0 8px 32px rgba(0,0,0,.2);padding:30px;color:#333}
    h1{text-align:center;font-size:1.7rem;background:linear-gradient(45deg,var(--primary),var(--secondary));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    p.sub{text-align:center;font-size:.9rem;opacity:.8;margin-bottom:25px}
    label{font-weight:600;margin-bottom:8px;display:block}
    input{width:100%;padding:14px;border:2px solid #ddd;border-radius:var(--radius);font-size:1rem;transition:border .3s}
    input:focus{outline:none;border-color:var(--primary)}
    button{width:100%;padding:14px;margin-top:12px;border:none;border-radius:var(--radius);font-size:1.05rem;font-weight:600;color:#fff;background:linear-gradient(45deg,var(--primary),var(--secondary));cursor:pointer;transition:transform .2s}
    button:hover{transform:translateY(-2px)}
    button:disabled{background:#bbb;cursor:not-allowed;transform:none}
    .loading{text-align:center;margin:20px 0;display:none}
    .spinner{width:40px;height:40px;border:4px solid rgba(255,255,255,.3);border-top-color:var(--primary);border-radius:50%;animation:spin 1s linear infinite;margin:0 auto 10px}
    @keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
    .result{display:none;margin-top:25px}
    video{width:100%;border-radius:var(--radius);margin-bottom:12px}
    .meta{background:#f5f5f5;padding:12px;border-radius:var(--radius);font-size:.9rem;margin-bottom:12px}
    .error{color:var(--error);font-weight:600;margin-top:10px;display:none}
    footer{text-align:center;margin-top:25px;font-size:.8rem;opacity:.7}
  </style>
</head>
<body>
  <div class="card">
    <h1>TikTok Downloader</h1>
    <p class="sub">HD video &nbsp;•&nbsp; No watermark &nbsp;•&nbsp; Unlimited</p>

    <label for="url">Paste TikTok video URL:</label>
    <input type="url" id="url" placeholder="https://www.tiktok.com/@user/video/1234567890">

    <button id="getBtn">Get Video</button>

    <div class="loading" id="loading">
      <div class="spinner"></div>
      <div>Processing…</div>
    </div>

    <div class="error" id="errorBox"></div>

    <div class="result" id="result">
      <div class="meta">
        <div id="metaTitle"></div>
        <div id="metaAuthor"></div>
      </div>
      <video id="preview" controls></video>
      <button id="dlBtn" class="btn" style="background:linear-gradient(45deg,var(--success),#66bb6a)">Download MP4 (no watermark)</button>
    </div>

    <footer>Free for personal use • Respect creators' rights</footer>
  </div>

  <script>
    const API = 'https://tikmob.mohammedmila022.workers.dev'; // <<< your worker

    const $ = id => document.getElementById(id);
    const urlInp = $('url'), getBtn = $('getBtn'), loading = $('loading'), errorBox = $('errorBox');
    const result = $('result'), preview = $('preview'), dlBtn = $('dlBtn');
    const metaTitle = $('metaTitle'), metaAuthor = $('metaAuthor');

    let downloadLink = '';

    getBtn.addEventListener('click', fetchVideo);
    dlBtn.addEventListener('click', () => {
      if (!downloadLink) return;
      const a = document.createElement('a');
      a.href = downloadLink;
      a.download = 'tiktok-no-wm.mp4';
      document.body.appendChild(a); a.click(); a.remove();
    });
    urlInp.addEventListener('keyup', e => { if (e.key === 'Enter') fetchVideo(); });

    async function fetchVideo() {
      const url = urlInp.value.trim();
      if (!url) return flash('Please enter a TikTok URL.');
      if (!url.includes('tiktok.com')) return flash('Invalid TikTok URL.');

      hideError(); setState('load');

      try {
        const res = await fetch(`${API}?url=${encodeURIComponent(url)}`);
        if (!res.ok) throw new Error('Network error ' + res.status);
        const json = await res.json();
        if (json.error) throw new Error(json.error);

        downloadLink = json.hd;
        preview.src = json.hd;
        metaTitle.textContent = json.title;
        metaAuthor.textContent = 'Author: ' + json.author;

        setState('result');
      } catch (e) {
        flash(e.message);
        setState('idle');
      }
    }

    function setState(st) {
      loading.style.display = st === 'load' ? 'block' : 'none';
      getBtn.disabled = st === 'load';
      result.style.display = st === 'result' ? 'block' : 'none';
    }
    function flash(msg) {
      errorBox.textContent = msg;
      errorBox.style.display = 'block';
      setTimeout(() => errorBox.style.display = 'none', 4000);
    }
    function hideError() { errorBox.style.display = 'none'; }

    // auto-focus input on load
    urlInp.focus();
  </script>
</body>
</html>
